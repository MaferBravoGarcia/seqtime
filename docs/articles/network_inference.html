<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network inference with LIMITS • seqtime</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">seqtime</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hallucigenia-sparsa/seqtime">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Network inference with LIMITS</h1>
                        <h4 class="author">Karoline Faust</h4>
            
            <h4 class="date">2017-11-17</h4>
          </div>

    
    
<div class="contents">
<p>We start by loading the seqtime library.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(seqtime)</code></pre></div>
<p>Next, we generate a “known” interaction matrix randomly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N=<span class="dv">20</span>
A=<span class="kw"><a href="../reference/generateA.html">generateA</a></span>(N, <span class="dt">c=</span><span class="fl">0.1</span>)</code></pre></div>
<pre><code>## [1] "Adjusting connectance to 0.1"
## [1] "Initial edge number 400"
## [1] "Initial connectance 1"
## [1] "Number of edges removed 342"
## [1] "Final connectance 0.1"
## [1] "Final connectance: 0.1"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(A)=<span class="kw">c</span>(<span class="dv">1</span>:N)
<span class="kw">colnames</span>(A)=<span class="kw">rownames</span>(A)</code></pre></div>
<p>Below, we plot our known interaction matrix. Green entries stand for a positive interaction of species i with species j, whereas red entries stand for a negative interaction of species i with species j (where i and j are row and column indices, respectively). For instance, a competition consists of two red entries for the negative impact of species i on j and species j on i. The diagonal is entirely red, since the interaction matrix is generated by default with negative values on the diagonal, which represent intra-species competition.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotA.html">plotA</a></span>(A, <span class="dt">header=</span><span class="st">"Known interaction matrix"</span>)</code></pre></div>
<pre><code>## [1] "Largest value: 0.459354281891137"
## [1] "Smallest value: -0.5"</code></pre>
<p><img src="figure_network_inference/unnamed-chunk-3-1.png" width="576"></p>
<p>We can also visualize the interaction matrix as a network. In contrast to correlation networks, the network is directed. Thus, it can represent asymmetric ecological relationships. For example, consider a parasitic relationship, where species i benefits at the cost of species j. It would be represented in the matrix by a positive entry in row i and column j and a negative entry in row j and column i. In the directed network, this parasitic relationship would correspond to two arcs, one from species i to species j and a reverse one from species j to species i. The negative diagonal entries are represented as self-loops.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">network=<span class="kw"><a href="../reference/plotA.html">plotA</a></span>(A,<span class="dt">method=</span><span class="st">"network"</span>)</code></pre></div>
<pre><code>## [1] "Largest value: 0.459354281891137"
## [1] "Smallest value: -0.5"
## [1] "Initial edge number 58"
## [1] "Initial connectance 0.1"
## [1] "Final connectance: 0.1"</code></pre>
<p><img src="figure_network_inference/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># use igraph's function tkplot for manual layout of the network</span></code></pre></div>
<p>Given our interaction matrix, we can now simulate a test time series with the Ricker community model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out.ricker=<span class="kw"><a href="../reference/ricker.html">ricker</a></span>(N,<span class="dt">A=</span>A)
<span class="kw"><a href="../reference/tsplot.html">tsplot</a></span>(out.ricker,<span class="dt">header=</span><span class="st">"Ricker"</span>)</code></pre></div>
<p><img src="figure_network_inference/unnamed-chunk-5-1.png" width="576"></p>
<p>Now, we run LIMITS to test how well it can infer the known interaction matrix from the time series. LIMITS was developed by Fisher and Mehta <a href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0102451">PLoS ONE 2014</a>. LIMITS needs a minute to run and then returns the estimated interaction matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Aest=<span class="kw"><a href="../reference/limits.html">limits</a></span>(out.ricker)</code></pre></div>
<pre><code>## [1] "Time series has 20 taxa"</code></pre>
<p>To compare the known and inferred interaction matrix, we can plot them next to each other:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw"><a href="../reference/plotA.html">plotA</a></span>(A,<span class="dt">header=</span><span class="st">"known"</span>)</code></pre></div>
<pre><code>## [1] "Largest value: 0.459354281891137"
## [1] "Smallest value: -0.5"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotA.html">plotA</a></span>(Aest,<span class="dt">header=</span><span class="st">"inferred"</span>)</code></pre></div>
<pre><code>## [1] "Largest value: 1.32167158580934"
## [1] "Smallest value: -2.03486534500416"</code></pre>
<p><img src="figure_network_inference/unnamed-chunk-7-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<p>We can also compute the mean cross-correlation of the known and inferred interaction matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crossCor=<span class="kw">cor</span>(A,Aest)
<span class="kw">mean</span>(<span class="kw">diag</span>(crossCor), <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 0.765336</code></pre>
<p>Finally, we can plot a few quality estimators for the interaction matrix inference. The quality plot displays the correlation between current and future time points one to five steps ahead (autocor) and the correlation between the original time series and a time series generated from the inferred interaction matrix step by step (cor). We can see that the predicted time series barely outperforms lag-one auto-correlation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">limitsqual=<span class="kw"><a href="../reference/limitsQuality.html">limitsQuality</a></span>(out.ricker,<span class="dt">A=</span>Aest,<span class="dt">plot=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] "Applying Schur decomposition"
## [1] "Initial edge number 47"
## [1] "Initial connectance 0.0710526315789474"
## [1] "Final connectance: 0.0710526315789474"</code></pre>
<p><img src="figure_network_inference/unnamed-chunk-9-1.png" width="576"></p>
<p>For comparison, we now generate a neutral time series with the Hubbell model. This model does not take species interactions into account and hence does not take the interaction matrix A as an input.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out.hubbell=<span class="kw"><a href="../reference/simHubbell.html">simHubbell</a></span>(<span class="dt">N=</span>N, <span class="dt">M=</span>N,<span class="dt">I=</span><span class="dv">1500</span>,<span class="dt">d=</span>N, <span class="dt">m=</span><span class="fl">0.1</span>, <span class="dt">tskip=</span><span class="dv">500</span>, <span class="dt">tend=</span><span class="dv">1000</span>)
<span class="kw"><a href="../reference/tsplot.html">tsplot</a></span>(out.hubbell,<span class="dt">header=</span><span class="st">"Hubbell"</span>)</code></pre></div>
<p><img src="figure_network_inference/unnamed-chunk-10-1.png" width="576"></p>
<p>We infer an interaction matrix from the neutral time series:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Aesth=<span class="kw"><a href="../reference/limits.html">limits</a></span>(out.hubbell)</code></pre></div>
<pre><code>## [1] "Time series has 20 taxa"</code></pre>
<p>The quality plot shows that the inferred interaction matrix leads to a high cross-correlation between predicted and original time series, even though the model underlying the original time series does not feature an interaction matrix. Thus, a high correlation between predicted and original time series can be misleading as an indicator for the quality of the inferred interaction matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">limitsqualh=<span class="kw"><a href="../reference/limitsQuality.html">limitsQuality</a></span>(out.hubbell,<span class="dt">A=</span>Aesth, <span class="dt">plot=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] "Applying Schur decomposition"
## [1] "Initial edge number 49"
## [1] "Initial connectance 0.0763157894736842"
## [1] "Final connectance: 0.623684210526316"</code></pre>
<p><img src="figure_network_inference/unnamed-chunk-12-1.png" width="576"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Karoline Faust, Franziska Bauchinger, Sophie de Buyl, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
