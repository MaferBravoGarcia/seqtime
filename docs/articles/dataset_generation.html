<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generating synthetic datasets with seqtime and generalized Lotka-Volterra â€¢ seqtime</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">seqtime</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hallucigenia-sparsa/seqtime">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Generating synthetic datasets with seqtime and generalized Lotka-Volterra</h1>
                        <h4 class="author">Lisa Rottjers</h4>
            
            <h4 class="date">21 december 2017</h4>
          </div>

    
    
<div class="contents">
<p>Start by loading the seqtime library as well as ggplot2. To make plotting easier, we are going to use the ggplot2 package together with reshape2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(seqtime)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(reshape2)</code></pre></div>
<p>We are going to generate a simulated dataset with 50 species, 40 samples. We first need to generate an interaction matrix. We are using the Klemm-Eguiluz algorithm, as this produces modular and scale-free networks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N =<span class="st"> </span><span class="dv">50</span>
S =<span class="st"> </span><span class="dv">40</span>
A =<span class="st"> </span><span class="kw"><a href="../reference/generateA.html">generateA</a></span>(N, <span class="st">"klemm"</span>, <span class="dt">pep=</span><span class="dv">10</span>, <span class="dt">c =</span><span class="fl">0.05</span>)</code></pre></div>
<pre><code>## [1] "Adjusting connectance to 0.05"
## [1] "Initial edge number 520"
## [1] "Initial connectance 0.191836734693878"
## [1] "Number of edges removed 348"
## [1] "Final connectance 0.0497959183673469"
## [1] "Final connectance: 0.0497959183673469"
## [1] "Initial edge number 172"
## [1] "Initial connectance 0.0497959183673469"
## [1] "Number of negative edges already present: 50"
## [1] "Converting 105 edges into negative edges"
## [1] "Final connectance: 0.0497959183673469"
## [1] "Final arc number (excluding self-arcs) 122"
## [1] "Final negative arc number (excluding self-arcs) 105"
## [1] "PEP: 13.9344262295082"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotA.html">plotA</a></span>(A, <span class="dt">header=</span><span class="st">"Klemm-Eguiluz interaction matrix"</span>)</code></pre></div>
<pre><code>## [1] "Largest value: 0.469801587652357"
## [1] "Smallest value: -0.5"</code></pre>
<p><img src="dataset_generation_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Normally, we would need to generate initial abundances so we could perform the gLV calculations. The dataset generation function takes care of that, but if you want to have different initial abundances than those generated from the Poisson distribution, you can change the mode parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dataset =<span class="st"> </span><span class="kw"><a href="../reference/generateDataSet.html">generateDataSet</a></span>(S, A)
dataset =<span class="st"> </span><span class="kw"><a href="../reference/normalize.html">normalize</a></span>(dataset)
dataset =<span class="st"> </span><span class="kw">melt</span>(dataset)
<span class="kw">colnames</span>(dataset) =<span class="st"> </span><span class="kw">c</span>(<span class="st">"Species"</span>, <span class="st">"Sample"</span>, <span class="st">"Abundance"</span>)
<span class="kw">ggplot</span>(<span class="dt">data=</span>dataset, <span class="kw">aes</span>(<span class="dt">x=</span>dataset$Sample, <span class="dt">y=</span>dataset$Abundance, <span class="dt">width=</span><span class="dv">1</span>)) +<span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> dataset$Abundance, <span class="dt">x=</span> dataset$Sample, <span class="dt">fill=</span>dataset$Species), <span class="dt">data=</span>dataset, <span class="dt">stat=</span><span class="st">"identity"</span>, <span class="dt">show.legend=</span>F) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">aspect.ratio=</span>.<span class="dv">4</span>) +<span class="st"> </span><span class="kw">theme_classic</span>()+<span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Relative abundance"</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">"Sample"</span>)</code></pre></div>
<p><img src="dataset_generation_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>We can also generate the dataset with environmental perturbations. For that, we first generate a suitable environmental matrix. We also tell the dataset function how many samples receive which perturbation. The abundance profile shifts as a result.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">env =<span class="st"> </span><span class="kw"><a href="../reference/envGrowthChanges.html">envGrowthChanges</a></span>(N, <span class="dt">strength=</span><span class="fl">0.8</span>)
dataset =<span class="st"> </span><span class="kw"><a href="../reference/generateDataSet.html">generateDataSet</a></span>(S, A, <span class="dt">env.matrix=</span>env, <span class="dt">perturb.count=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>))
dataset =<span class="st"> </span><span class="kw"><a href="../reference/normalize.html">normalize</a></span>(dataset)
dataset =<span class="st"> </span><span class="kw">melt</span>(dataset)
<span class="kw">colnames</span>(dataset) =<span class="st"> </span><span class="kw">c</span>(<span class="st">"Species"</span>, <span class="st">"Sample"</span>, <span class="st">"Abundance"</span>)
<span class="kw">ggplot</span>(<span class="dt">data=</span>dataset, <span class="kw">aes</span>(<span class="dt">x=</span>dataset$Sample, <span class="dt">y=</span>dataset$Abundance, <span class="dt">width=</span><span class="dv">1</span>)) +<span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> dataset$Abundance, <span class="dt">x=</span> dataset$Sample, <span class="dt">fill=</span>dataset$Species), <span class="dt">data=</span>dataset, <span class="dt">stat=</span><span class="st">"identity"</span>, <span class="dt">show.legend=</span>F) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">aspect.ratio=</span>.<span class="dv">4</span>) +<span class="st"> </span><span class="kw">theme_classic</span>()+<span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Relative abundance"</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">"Sample"</span>)</code></pre></div>
<p><img src="dataset_generation_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Karoline Faust, Franziska Bauchinger, Sophie de Buyl, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
